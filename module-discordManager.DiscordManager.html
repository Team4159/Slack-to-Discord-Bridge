<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: DiscordManager</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: DiscordManager</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>
            <span class="ancestors"><a href="module-discordManager.html">discordManager</a>.</span>DiscordManager<span class="signature">(SlackWebAPIClient)</span><span class="type-signature"></span></h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    
    <h4 class="name" id="DiscordManager"><span class="type-signature"></span>new DiscordManager<span class="signature">(SlackWebAPIClient)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    A class that manages parsing from Slack to Discord formats and sending out to channels
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>SlackWebAPIClient</code></td>
            

            <td class="type">
            
                
<span class="param-type">WebClient</span>


            
            </td>

            

            

            <td class="description last">The Slack web client that allows interaction with their api</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line18">line 18</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="attachmentEmbeds"><span class="type-signature">(async, static) </span>DiscordManager#attachmentEmbeds<span class="signature">(embedArr, slackFiles)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;Object>>}</span></h4>
    

    



<div class="description">
    Parses the array of Slack files attached to a message by downloading them and adding ones that are under 8MB as embeds and those over 8MB as linksNotes: Discord auto-embeds ["mp3", "ogg", "wav", "flac"] formats and ["gif"] does not like to be embedded for some odd reason.Video formats such as ["mov", "webm", "mp4"] will auto-embed but sometimes fail to load but the original can still be downloaded from the "See Original" link
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>embedArr</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;MessageEmbed></span>


            
            </td>

            

            

            <td class="description last">Array to add file embeds onto. Assumed to have at least 1 embed inside it before the function is called</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackFiles</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Object></span>


            
            </td>

            

            

            <td class="description last">Array of Objects from a Slack message event that includes their download URLs. Passed to fileManager.fileDownload. Can be obtained through event.files</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line120">line 120</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of objects containing details on where the file is, what is is called, the original Slack file object, and more. Originates from resolving fileManager.fileDownload on all files
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;Object>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="delete"><span class="type-signature">(async, static) </span>DiscordManager#delete<span class="signature">(channel, slackIdentifier)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Deletes messages associated with a given Slack message ID
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>channel</code></td>
            

            <td class="type">
            
                
<span class="param-type">TextChannel</span>


            
            </td>

            

            

            <td class="description last">The Discord text channel where the message-to-be-deleted is</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackIdentifier</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The ID used for the Slack message associated with the Discord message</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line201">line 201</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="embedSender"><span class="type-signature">(async, static) </span>DiscordManager#embedSender<span class="signature">(discordChannel, discordEmbeds, mapTo<span class="signature-attributes">opt</span>, canHaveText)</span><span class="type-signature"> &rarr; {Promise.&lt;Array.&lt;Message>>}</span></h4>
    

    



<div class="description">
    Handles sending out all the embeds into a Discord channel and storing their IDs in the SQLite database
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>discordChannel</code></td>
            

            <td class="type">
            
                
<span class="param-type">TextChannel</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">The Discord text channel where the messages/embeds will be logged to</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>discordEmbeds</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;MessageEmbed></span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">Array of Discord embeds to send out</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>mapTo</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">The ID used for the Slack message associated with the Discord messages. Use if the message ids should be kept in the database for future edits and deletions</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>canHaveText</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                    true
                
                </td>
            

            <td class="description last">Whether or not to mark the first embed as the embed to edit if text changes. Assumes first embed in array is the one with text from the Slack message</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line218">line 218</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Array of the Discord messages sent to the channel and their details. Originates from TextChannel.send
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;Array.&lt;Message>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="identify"><span class="type-signature">(static) </span>DiscordManager#identify<span class="signature">(channel, ts)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Use on a Slack event to generate an id for messages that SHOULD be unique (No official documentation found)
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>channel</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The Slack Channel id. Can be obtained through event.channel</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>ts</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            

            

            <td class="description last">The timestamp of the Slack message</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line262">line 262</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="locateChannel"><span class="type-signature">(async, static) </span>DiscordManager#locateChannel<span class="signature">(slackChannelID)</span><span class="type-signature"> &rarr; {Promise.&lt;GuildChannel>}</span></h4>
    

    



<div class="description">
    Locates a channel given a Slack Channel ID. Will grab associated channel from the serverMap.json or search by name. If it does not exist, the bot will create a channel with a matching name and serverMap it
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>slackChannelID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The Slack Channel id. Can be obtained through event.channel</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line74">line 74</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Returns the located Discord channel
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;GuildChannel></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="setPin"><span class="type-signature">(async, static) </span>DiscordManager#setPin<span class="signature">(pin<span class="signature-attributes">opt</span>, slackChannelID, slackUserID, slackTs)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Handles pinning and unpinning a logged message on the Discord side
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>pin</code></td>
            

            <td class="type">
            
                
<span class="param-type">boolean</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    false
                
                </td>
            

            <td class="description last">Pins the message if true and unpins it if false</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackChannelID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">The Slack Channel id. Can be obtained through event.channel</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackUserID</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">The Slack user ID of the person pinning the message on Slack</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackTs</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last">The timestamp of the pinned Slack message. Used with the channel ID to identify the message and find it</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line242">line 242</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="slackTextParse"><span class="type-signature">(async, static) </span>DiscordManager#slackTextParse<span class="signature">(text)</span><span class="type-signature"> &rarr; {Promise.&lt;string>}</span></h4>
    

    



<div class="description">
    Converts Slack markdown to Discord markdown. Has some acceptable edge cases
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>text</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Slack text to convert</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line283">line 283</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    Resulting text with Discord markdown
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;string></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="start"><span class="type-signature">(async, static) </span>DiscordManager#start<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Starts up the Discord Bot responsible for logging messages, locates the logging guild, and loads the serverMap.json to (dataManager.js).load()
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line33">line 33</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="textUpdate"><span class="type-signature">(async, static) </span>DiscordManager#textUpdate<span class="signature">(channel, slackIdentifier, newText)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Updates the text of a message already logged to Discord
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>channel</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The Slack Channel id. Can be obtained through event.channel</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>slackIdentifier</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The ID used for the Slack message associated with the Discord message</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>newText</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">What to change the text to</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line185">line 185</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="userIdentify"><span class="type-signature">(static) </span>DiscordManager#userIdentify<span class="signature">(user)</span><span class="type-signature"> &rarr; {string}</span></h4>
    

    



<div class="description">
    Creates a more readable name for each user than their user ID
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>user</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">User object obtained through the Slack users.info endpoint</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="discordManager.js.html">discordManager.js</a>, <a href="discordManager.js.html#line272">line 272</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    String to use as their username when logging messages
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    





        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-databaseManager.html">databaseManager</a></li><li><a href="module-dataManager.html">dataManager</a></li><li><a href="module-discordManager.html">discordManager</a></li><li><a href="module-fileManager.html">fileManager</a></li><li><a href="module-fileServer.html">fileServer</a></li><li><a href="module-Start.html">Start</a></li></ul><h3>Externals</h3><ul><li><a href="external-SlackEventAdapter.html">SlackEventAdapter</a></li><li><a href="external-WebClient.html">WebClient</a></li></ul><h3>Classes</h3><ul><li><a href="module-discordManager.DiscordManager.html">DiscordManager</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Wed Jan 20 2021 16:44:29 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>